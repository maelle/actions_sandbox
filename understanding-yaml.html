<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 So what’s actually going on in the yaml file? | Github actions with R</title>
  <meta name="description" content="An introduction to using github actions with R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 So what’s actually going on in the yaml file? | Github actions with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to using github actions with R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 So what’s actually going on in the yaml file? | Github actions with R" />
  
  <meta name="twitter:description" content="An introduction to using github actions with R." />
  

<meta name="author" content="Chris Brown, Murray Cadzow, Paula A Martinez, Rhydwyn McGuire, David Neuzerling, David Wilkinson, Saras Windecker" />


<meta name="date" content="2020-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="websites-using-pkgdown-bookdown-and-blogdown.html"/>
<link rel="next" href="testing-with-renev.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Github Actions with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-are-github-actions"><i class="fa fa-check"></i><b>1.1</b> What are GitHub Actions?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#usethis-wrappers"><i class="fa fa-check"></i><b>1.1.1</b> Usethis Wrappers</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#marketplace-actions"><i class="fa fa-check"></i><b>1.1.2</b> Marketplace Actions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#extensions"><i class="fa fa-check"></i><b>1.2</b> Extensions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#more-information-and-useful-links"><i class="fa fa-check"></i><b>1.3</b> More information and useful links</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="packageci.html"><a href="packageci.html"><i class="fa fa-check"></i><b>2</b> Example workflow to set up continuous integration for packages</a><ul>
<li class="chapter" data-level="2.1" data-path="packageci.html"><a href="packageci.html#set-up-package"><i class="fa fa-check"></i><b>2.1</b> Set up package</a><ul>
<li class="chapter" data-level="2.1.1" data-path="packageci.html"><a href="packageci.html#new-project-github-first"><i class="fa fa-check"></i><b>2.1.1</b> New project, GitHub first</a></li>
<li class="chapter" data-level="2.1.2" data-path="packageci.html"><a href="packageci.html#existing-package-with-github"><i class="fa fa-check"></i><b>2.1.2</b> Existing package with GitHub</a></li>
<li class="chapter" data-level="2.1.3" data-path="packageci.html"><a href="packageci.html#add-github-links-to-description"><i class="fa fa-check"></i><b>2.1.3</b> Add GitHub links to DESCRIPTION</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="packageci.html"><a href="packageci.html#actions-for-continuous-integration-checks"><i class="fa fa-check"></i><b>2.2</b> Actions for continuous integration checks</a><ul>
<li class="chapter" data-level="2.2.1" data-path="packageci.html"><a href="packageci.html#ci-release-check"><i class="fa fa-check"></i><b>2.2.1</b> CI release check</a></li>
<li class="chapter" data-level="2.2.2" data-path="packageci.html"><a href="packageci.html#ci-full-check"><i class="fa fa-check"></i><b>2.2.2</b> CI full check</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="packageci.html"><a href="packageci.html#triggering-actions"><i class="fa fa-check"></i><b>2.3</b> Triggering actions</a></li>
<li class="chapter" data-level="2.4" data-path="packageci.html"><a href="packageci.html#did-it-succeed"><i class="fa fa-check"></i><b>2.4</b> Did it succeed?</a></li>
<li class="chapter" data-level="2.5" data-path="packageci.html"><a href="packageci.html#what-next"><i class="fa fa-check"></i><b>2.5</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="websites-using-pkgdown-bookdown-and-blogdown.html"><a href="websites-using-pkgdown-bookdown-and-blogdown.html"><i class="fa fa-check"></i><b>3</b> Websites using pkgdown, bookdown, and blogdown</a><ul>
<li class="chapter" data-level="3.1" data-path="websites-using-pkgdown-bookdown-and-blogdown.html"><a href="websites-using-pkgdown-bookdown-and-blogdown.html#ghpages-setup"><i class="fa fa-check"></i><b>3.1</b> Create gh-pages branch</a></li>
<li class="chapter" data-level="3.2" data-path="websites-using-pkgdown-bookdown-and-blogdown.html"><a href="websites-using-pkgdown-bookdown-and-blogdown.html#deploy-pkgdown"><i class="fa fa-check"></i><b>3.2</b> Action to deploy a pkgdown site</a></li>
<li class="chapter" data-level="3.3" data-path="websites-using-pkgdown-bookdown-and-blogdown.html"><a href="websites-using-pkgdown-bookdown-and-blogdown.html#deploy-bookdown"><i class="fa fa-check"></i><b>3.3</b> Action to deploy a bookdown site</a></li>
<li class="chapter" data-level="3.4" data-path="websites-using-pkgdown-bookdown-and-blogdown.html"><a href="websites-using-pkgdown-bookdown-and-blogdown.html#deploy-blogdown"><i class="fa fa-check"></i><b>3.4</b> Action to deploy a blogdown site</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="understanding-yaml.html"><a href="understanding-yaml.html"><i class="fa fa-check"></i><b>4</b> So what’s actually going on in the yaml file?</a><ul>
<li class="chapter" data-level="4.1" data-path="understanding-yaml.html"><a href="understanding-yaml.html#github-action-options"><i class="fa fa-check"></i><b>4.1</b> GitHub action options</a></li>
<li class="chapter" data-level="4.2" data-path="understanding-yaml.html"><a href="understanding-yaml.html#secrets"><i class="fa fa-check"></i><b>4.2</b> GitHub Secrets</a><ul>
<li class="chapter" data-level="4.2.1" data-path="understanding-yaml.html"><a href="understanding-yaml.html#github-pat"><i class="fa fa-check"></i><b>4.2.1</b> Personal access tokens</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="testing-with-renev.html"><a href="testing-with-renev.html"><i class="fa fa-check"></i><b>5</b> Testing with a reproducible environment</a></li>
<li class="chapter" data-level="6" data-path="contributions.html"><a href="contributions.html"><i class="fa fa-check"></i><b>6</b> Community contributions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Github actions with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="understanding-yaml" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> So what’s actually going on in the yaml file?</h1>
<p>Note: you can use <code>.yml</code> or <code>.yaml</code> as extension of your file for your workflow.</p>
<p>Let’s explore the <code>yaml</code> code for the first issue message here:</p>
<details>
<summary>click me code</summary>
<p>
<pre><code>    name: Greetings

    on: [pull_request, issues]

    jobs:
      greeting:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/first-interaction@v1
          with:
            repo-token: ${{ secrets.GH_TOKEN }}
            issue-message: &#39;Hi ! there!! thanks for your contribution!, you are awesome! &#39;
            pr-message: &#39;Hey what an input! please give us a bit of time to review it! We will be in touch soon.&#39;</code></pre>
</p>
</details>
<p>or here <a href="https://github.com/ropenscilabs/CIsandbox/blob/master/.github/workflows/greetings.yml">https://github.com/ropenscilabs/CIsandbox/blob/master/.github/workflows/greetings.yml</a>.</p>
<p>Translated, that says that the workflow action <strong>name</strong> is ‘Greetings’ and is triggered on pull requests and issues. It will start a job
with the name <em>greeting</em>, and will run on a <a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/core-concepts-for-github-actions#runner">runner</a> called <em>ubuntu-latest</em>. Then, each job has <a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/core-concepts-for-github-actions#step">steps</a> (here there is only one) that will pass commands to the runner or call externally-defined actions, possibly passing parameter values to those actions or setting up the environment by defining environment variables. See more about the <a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/workflow-syntax-for-github-actions">syntax</a>.</p>
<div id="github-action-options" class="section level2">
<h2><span class="header-section-number">4.1</span> GitHub action options</h2>
<p>Change the &lt;customizable bits&gt; as needed:</p>
<pre><code>on:
  push:
  pull-request:

name: &lt;nameyouraction&gt;

jobs:
  render:
    name: &lt;nameyourjob&gt;
    runs-on: macOS-latest
    steps:
      - uses: actions/checkout@v1
      - uses: r-lib/actions/setup-r@v1
      - uses: r-lib/actions/setup-pandoc@v1
      - name: &lt;namestep1&gt;
        run: Rscript -e &#39;install.packages(&quot;&lt;the package you need&gt;&quot;)&#39;
      - name: &lt;namestep2&gt;
        run: Rscript -e &#39;rmarkdown::render(&quot;examples/README.Rmd&quot;)&#39;
      - name: &lt;namestep3&gt;
        run: |
          git commit &lt;some file&gt;.md -m &#39;Re-build &lt;file&gt;.Rmd&#39; || echo &quot;No changes to commit&quot;
          git push https://${{github.actor}}:${{secrets.GH_TOKEN}}@github.com/${{github.repository}}.git HEAD:${{ github.ref }} || echo &quot;No changes to commit&quot;</code></pre>
<ul>
<li>The <code>on</code> parameter tells GitHub what should trigger this action. In this case, we want to check code whenever it is pushed, or on a pull request. The latter is particularly useful in the case of a CI action because if we’re about to merge code into the master branch, we want it to pass the tests!</li>
<li>The <code>name</code> of the action should be something that helps us identify at a glance what the action is doing. This is shown on github.com in the Actions tab of the repository.</li>
<li><code>runs-on</code> tells GitHub what sort of environment should run the job. These environments are called “runners”. GitHub supports Ubuntu, macOS and Windows Server, as well as self-hosted runners.</li>
<li><code>uses</code> allows us to run other actions as part of our action. In this case, we’re calling on actions that are defined in other repositories. The first action checks out the contents of our repository; the second and third then set up R and Pandoc.</li>
<li>The remaining steps, each with a name, contain the commands we want to run as part of our action. Here we’re installing the dependencies of our package. (In the R-CMD-check action produced by <code>usethis::use_github_action_check_release()</code> (see section 2.2.1), we install the <code>rcmdcheck</code> package as well—it’s what we use to check the package in our repository—and then we go ahead and do the check by calling the package-checking function it provides.)</li>
</ul>
</div>
<div id="secrets" class="section level2">
<h2><span class="header-section-number">4.2</span> GitHub Secrets</h2>
<p><a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets">GitHub secrets</a> are a way to use values in your yaml that need to remain secret, such as credentials or information you want to keep private. Commonly this would be a <a href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">GitHub personal access token</a> (<em>GH_PAT</em>) that enables the action to perform operations such as <em>push</em>. These are set under the repository settings menu.</p>
<p><img src="images/add_secret.png" /><!-- --></p>
<div id="github-pat" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Personal access tokens</h3>
<p>Personal access tokens can be generated with differing levels of authority. To create one for your account, go to <a href="https://github.com/settings/tokens" class="uri">https://github.com/settings/tokens</a> and click “Generate new token”. Then you can copy the value of the token into a secret for your repository so that a GitHub action can be authenticated as you.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="websites-using-pkgdown-bookdown-and-blogdown.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="testing-with-renev.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
